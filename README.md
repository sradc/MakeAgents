<!-- Copyright 2023 Sidney Radcliffe

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License. -->

<!-- Warning, README.md is autogenerated from README.ipynb, do not edit it directly -->


`pip install make_agents`

<p align="center">
  <img src="https://raw.githubusercontent.com/sradc/MakeAgents/master/README_files/make_agents_logo.jpg" width=256>
</p>

# MakeAgents

MakeAgents is a micro framework for creating LLM-driven agents. It currently supports OpenAI's GPT chat models.

The MakeAgents paradigm is to define an agent's behaviour and capabilities entirely through **action functions**, and an **action graph**. 

TODO: put this in a "concepts" tutorial, with examples for each:

- Action functions: capabilities of the agent, that also shape its behaviour, (can be considered as part of the prompt).
- Action graph: defines what actions the agent has access to at a given point in time. Can shape the behaviour, and e.g. make sure that certain actions have been carried out before other actions.
- Execution is carried out using a generator, which makes it easy to see and vet what the agent is doing / about to do.


## Quickstart examples

### Example 1: A conversational agent for getting the user's name


```python
import json
import pprint

from pydantic import BaseModel, Field

import make_agents as ma
```


```python
# Define action functions


@ma.action
def get_task_instructions():
    return "Your task is to get both the user's first and second name."


class MessageUserArg(BaseModel):
    question: str = Field(description="Question to ask user")


@ma.action
def message_user(arg: MessageUserArg):
    """Send the user a message, and get their response."""
    response = ""
    while response == "":
        response = input(arg.question).strip()
    return response


class LogNameArg(BaseModel):
    first_name: str = Field(description="User's first name")
    last_name: str = Field(description="User's last name")


@ma.action
def record_name(arg: LogNameArg):
    """Record the users first and last name."""
    return {"first_name": arg.first_name, "last_name": arg.last_name}


# Define action graph
action_graph = {
    ma.Start: [get_task_instructions],
    get_task_instructions: [message_user],
    message_user: [message_user, record_name],
}
display(ma.bonus.draw_graph(action_graph))

# Run the agent
for messages in ma.run_agent(action_graph):
    # `messages` contains the full message stack, so just print the most recent message
    ma.bonus.display_message_dict_jupyter(messages[-1])

print(f"Retrieved user_name: {json.loads(messages[-1]['content'])}")
```


    
![png](https://raw.githubusercontent.com/sradc/MakeAgents/master/README_files/README_3_0.png)
    



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>"Your task is to get both the user's first and second name."</td>
    </tr>
    <tr>
      <td>name</td>
      <td>get_task_instructions</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>None</td>
    </tr>
    <tr>
      <td>function_call</td>
      <td>{'name': 'message_user', 'arguments': '{
  "question": "What is your first name?"
}'}</td>
    </tr>
    <tr>
      <td>role</td>
      <td>assistant</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>"It's Bill"</td>
    </tr>
    <tr>
      <td>name</td>
      <td>message_user</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>None</td>
    </tr>
    <tr>
      <td>function_call</td>
      <td>{'name': 'select_next_func', 'arguments': '{
  "next_function": "message_user"
}'}</td>
    </tr>
    <tr>
      <td>role</td>
      <td>assistant</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>{"next_function": "message_user"}</td>
    </tr>
    <tr>
      <td>name</td>
      <td>select_next_func</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>None</td>
    </tr>
    <tr>
      <td>function_call</td>
      <td>{'name': 'message_user', 'arguments': '{
  "question": "What is your second name?"
}'}</td>
    </tr>
    <tr>
      <td>role</td>
      <td>assistant</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>"BoBaggins"</td>
    </tr>
    <tr>
      <td>name</td>
      <td>message_user</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>None</td>
    </tr>
    <tr>
      <td>function_call</td>
      <td>{'name': 'select_next_func', 'arguments': '{
  "next_function": "record_name"
}'}</td>
    </tr>
    <tr>
      <td>role</td>
      <td>assistant</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>{"next_function": "record_name"}</td>
    </tr>
    <tr>
      <td>name</td>
      <td>select_next_func</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>None</td>
    </tr>
    <tr>
      <td>function_call</td>
      <td>{'name': 'record_name', 'arguments': '{
  "first_name": "Bill",
  "last_name": "BoBaggins"
}'}</td>
    </tr>
    <tr>
      <td>role</td>
      <td>assistant</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>content</td>
      <td>{"first_name": "Bill", "last_name": "BoBaggins"}</td>
    </tr>
    <tr>
      <td>name</td>
      <td>record_name</td>
    </tr>
    <tr>
      <td>role</td>
      <td>function</td>
    </tr>
  </tbody>
</table>




<style> 
    .dataframe thead { display: none; } 
    .dataframe tbody tr th:only-of-type { display: none; }
    .dataframe tbody td { text-align: left; }
</style>



    Retrieved user_name: {'first_name': 'Bill', 'last_name': 'BoBaggins'}


### Notes:

Prompting has a big impact on the performance of the agent. The `llm_func` function names, Pydantic models and docstrings can all be considered part of the prompt.

### Contributing

It's early days for the framework...

- If you have an opinion, please raise an issue / start a discussion.
- If you have created something cool, please consider contributing (will put in `community_examples`)

### Dev setup

- Clone the repo and `cd` into it
- Run `poetry install`
- Run `poetry run pre-commit install`

